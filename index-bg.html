<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>–ü–ª–µ—Ç–µ–Ω–∏ –ì–µ—Ä–æ–∏</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@500;700&amp;display=swap&amp;subset=cyrillic" rel="stylesheet"/>

<style>
/* Lightbox —Ñ–æ–Ω */
.lightbox {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
.lightbox img {
  max-width: 90%;
  max-height: 90%;
  border-radius: 10px;
  box-shadow: 0 0 15px #000;
  border: 4px solid white;
  background: white;
}

.animated-bg {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: linear-gradient(-45deg, #ffb6b9, #ffdde1, #f9f9f9, #fff1f0);
  background-size: 400% 400%;
  animation: gradientAnimation 10s ease infinite;
  z-index: -1;
}
@keyframes gradientAnimation {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.hero { position: relative; z-index: 1; }
body {
  margin: 0;
  padding-top: 60px; /* –≤–∏—Å–æ—á–∏–Ω–∞—Ç–∞ –Ω–∞ –Ω–∞–≤ –±–∞—Ä–∞ */
  font-family: 'Quicksand', sans-serif;
  background-color: #fff9f5;
  color: #444;
}
.header {
  text-align: center;
  font-size: 2.7em;
  color: rgba(255,255,255,0.7);
  margin-top: 2px; font-weight: bold; padding: 0 10px; word-wrap: break-word;
}
@media (max-width: 768px) {
  .header { font-size: 1.6em; margin-top: 5px; padding: 0 5px; }
}

header h1 { margin: 0; color: white; }

nav {
  background-color: #ffe0e6;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 1000;
}
nav a, nav button {
  margin: 0 15px;
  text-decoration: none;
  color: #333;
  font-weight: bold;
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1em;
}

/* ====== –ü–ê–î–ê–©–ê –ö–û–õ–ò–ß–ö–ê –ü–û–î –ë–£–¢–û–ù–ê (–ù–û–í–û: 20 —Ä–µ–¥–∞) ====== */
.cart-wrap {               /* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞ –±—É—Ç–æ–Ω–∞ + –ø–∞–¥–∞—â–æ—Ç–æ –º–µ–Ω—é */
  margin-left: auto;
  position: relative;
}
#cart-button {             /* –º–∞—Ö–∞–º–µ auto –æ—Ç –±—É—Ç–æ–Ω–∞, —Ç–æ–π –µ –≤ .cart-wrap */
  margin-left: 0;
}
#cart-dropdown {
  position: absolute;
  top: calc(100% + 8px);   /* —Ç–æ—á–Ω–æ –ø–æ–¥ –±—É—Ç–æ–Ω–∞ */
  right: 0;                /* –∏–∑—Ä–∞–≤–Ω–µ–Ω –ø–æ –¥—è—Å–Ω–∞—Ç–∞ –º—É —Å—Ç—Ä–∞–Ω–∞ */
  background: #fff;
  border: 2px solid #ccc;
  border-radius: 10px;
  padding: 14px 16px 12px 16px;
  width: min(360px, 90vw);
  max-height: 60vh;
  overflow: auto;
  box-shadow: 0 8px 24px rgba(0,0,0,0.18);
  display: none;           /* —Å–∫—Ä–∏—Ç –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ */
  z-index: 2000;           /* –Ω–∞–¥ –Ω–∞–≤–±–∞—Ä–∞ */
}
#cart-dropdown.open { display: block; }
#cart-dropdown h2 { margin: 0 0 10px 0; font-size: 1.1em; }
#cart-dropdown .close-x {
  position: absolute; top: 8px; right: 10px;
  background: none; border: none; font-size: 18px; cursor: pointer;
}
#cart-items { padding-left: 20px; margin: 0; }
#cart-items li { margin: 6px 0; }

/* ======================================================== */

.hero {
  background: url('https://images.unsplash.com/photo-1559056199-641a0ac8b5cc?auto=format&fit=crop&w=1600&q=80') no-repeat center center/cover;
  height: 300px;
  display: flex; align-items: center; justify-content: center;
  color: white; font-size: 2em; text-shadow: 2px 2px 5px #000;
}
.container { padding: 20px; }
.product-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;
}
.product {
  background: white; border-radius: 10px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;
}
.product img {
  width: 100%; height: auto; max-height: 250px; object-fit: contain; cursor: pointer;
}

footer {
  background-color: #ffb6b9; color: white; text-align: center; padding: 20px; margin-top: 40px;
}
button {
  background-color: #ffb6b9; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer !important;
}

header h1 {
  margin: 0; color: white; font-family: 'Rubik', sans-serif; font-weight: 900; font-size: 3.2em;
  text-shadow:
    0 0 5px #ffccd5, 0 0 10px #ffb6c1, 0 0 15px #ff99aa, 0 0 25px #ff6f91;
}
.pulse-title {
  margin: 0; font-family: 'Rubik', sans-serif; font-weight: 900; font-size: 8vw; color: white;
  animation: pulse-glow 2.5s ease-in-out infinite; transition: transform 0.3s ease; text-align: center; padding: 0 5vw; word-wrap: break-word;
}
@keyframes pulse-glow {
  0% { text-shadow: 0 0 5px #ffccd5, 0 0 10px #ffb6c1, 0 0 15px #ff99aa, 0 0 25px #ff6f91; transform: scale(1); }
  50% { text-shadow: 0 0 10px #ffe0e6, 0 0 20px #ffb6c1, 0 0 30px #ff99aa, 0 0 40px #ff6f91; transform: scale(1.05); }
  100% { text-shadow: 0 0 5px #ffccd5, 0 0 10px #ffb6c1, 0 0 15px #ff99aa, 0 0 25px #ff6f91; transform: scale(1); }
}
.chat-button:hover { background-color: #ffa0a0; }
html, body { overflow-x: hidden; }
#chtl-launcher { display: none !important; }
.custom-chat-btn {
  margin-top: 10px; background: black; color: white; padding: 6px 12px; border-radius: 20px; cursor: pointer; font-size: 14px;
}
  @media (max-width: 768px){
  .product img{
    width: 100%;
    max-width: 100%;
    height: auto;
  }
}


#cart-footer{display:flex;justify-content:flex-end;margin-top:10px}
#whatsapp-order{background:#25D366;color:#fff;border:0;padding:8px 14px;border-radius:6px;font-weight:700;cursor:pointer}
#whatsapp-order:hover{background:#20b857}

</style>
</head>

<body>
<!-- Lightbox (–≤—ä—Ç—Ä–µ –≤ body) -->
<div class="lightbox" id="lightbox" onclick="this.style.display='none'">
  <img id="lightbox-img" src="" alt="Full Image"/>
</div>

<div class="animated-bg"></div>
<header>
  <h1 class="pulse-title">–∞–º–∏–≥—É—Ä—É–º–µ–Ω–∏—á–µ—Ç–∞</h1>
</header>

<nav>
  <a href="#shop">–ú–∞–≥–∞–∑–∏–Ω</a>
  <a href="#contact">–ö–æ–Ω—Ç–∞–∫—Ç</a>
  <button onclick="window.location.href='index.html'">English</button>

  <!-- ===== –ö–∞—Ä—Ç–∞ + –ø–∞–¥–∞—â–æ –º–µ–Ω—é (–ù–û–í–û: 9 —Ä–µ–¥–∞) ===== -->
  <span class="cart-wrap">
    <button id="cart-button">üõí (<span id="cart-count">0</span>)</button>
    <div id="cart-dropdown" aria-hidden="true">
      <button class="close-x" id="close-cart" aria-label="–ó–∞—Ç–≤–æ—Ä–∏">‚úñ</button>
      <h2>–¢–≤–æ—è—Ç–∞ –∫–æ–ª–∏—á–∫–∞</h2>
      <ul id="cart-items"></ul>
      <div id="cart-footer">
        <button id="whatsapp-order">–ü–æ—Ä—ä—á–∞–π –≤ WhatsApp</button>
      </div>
    </div>
  </span>
  <!-- =============================================== -->
</nav>

<div class="container" id="shop">
  <h2>–∫–ª–∏–∫–Ω–∏ –∏ –≥–æ–≤–æ—Ä–∏ —Å –∫—É–∫–ª–∏—Ç–µ –æ—Ç–¥–æ–ª—É</h2>
  <div class="product-grid">
    <div class="product-card" style="display:none;">
      <img alt="–õ—É–Ω–∞ –ú–∏—à–∫–∞—Ç–∞" src="luna.png"/>
      <h3>–ú–∏—à–ª–µ—Ç–æ –ú—É—à–∫–æ</h3>
      <p>–õ—é–±–æ–ø–∏—Ç–Ω–æ —Ä–æ–∑–æ–≤–æ –º–∏—à–ª–µ, –∫–æ–µ—Ç–æ –æ–±–æ–∂–∞–≤–∞ —è–≥–æ–¥–∫–∏ –∏ –ø—Ä–∏–∫–∞–∑–∫–∏ –∑–∞ –ª–µ–∫–∞ –Ω–æ—â. –†–∞–¥–æ—Å—Ç –∑–∞ –≤—Å—è–∫–∞ –¥–µ—Ç—Å–∫–∞ —Å—Ç–∞—è!</p>
      <p><strong>‚Ç¨18.00</strong></p>
      <button class="add-to-cart">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
    </div>

    <div class="product-card" style="display:none;">
      <img alt="–ë–æ—Ä–∏—Å –ú–µ—á–µ—Ç–æ" src="boris.png"/>
      <h3>–ë–æ–±–∏ –ú–µ—á–µ—Ç–æ</h3>
      <p>–°–º–µ–ª –∏ –≥—É—à–ª–∏–≤, –ë–æ–±–∏ –ø–∞–∑–∏ —Å—ä–Ω–∏—â–∞—Ç–∞ –∏ –æ–±–∏—á–∞ —Ç–æ–ø–ª–∏ –ø—Ä–µ–≥—Ä—ä–¥–∫–∏. –ò–¥–µ–∞–ª–µ–Ω –∑–∞ –¥–µ—Üa –æ—Ç 1 –¥–æ 100 –≥–æ–¥–∏–Ω–∫–∏.</p>
      <p><strong>‚Ç¨22.00</strong></p>
      <button class="add-to-cart">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
    </div>

    <div class="product-card" style="display:none;">
      <img alt="–ì–æ–ª–µ–º–∏—è—Ç –ë–æ—Ä–∏—Å" src="boris-big.png"/>
      <h3>–ì–æ–ª–µ–º–∏—è—Ç –ë–æ–±–∏</h3>
      <p>–ü–æ-–≥–æ–ª—è–º–∞ –∏ –ø–æ-—Ç—ä–º–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞ –ë–æ–±–∏. –°—ä–∑–¥–∞–¥–µ–Ω –∑–∞ —Å—É–ø–µ—Ä –≥—É—à–∫–∞–Ω–µ –∏ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∑–∞—â–∏—Ç–∞ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ —Å—ä–Ω.</p>
      <p><strong>‚Ç¨32.00</strong></p>
      <button class="add-to-cart">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
    </div>

    <div class="product">
      <img alt="–ü–∞–Ω—Ç–µ—Ä–∞—Ç–∞ –ü–µ–Ω–∞" src="penka.png"/>
      <h3>–ü–∞–Ω—Ç–µ—Ä–∞—Ç–∞ –ü–µ–Ω–∞</h3>
      <p>–¢—è –µ –æ—Ç –®—É–º–µ–Ω,–∞–º–∞ –Ω–µ –∏ —Å–µ —Å—Ç–æ–∏ —Ç–∞–º....                                                             .</p>
      <p><strong>‚Ç¨42.00</strong></p>
      <button class="add-to-cart">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
    </div>

    <div class="product">
      <a href="popilian.html"><img src="popilian.png" alt="–ü–æ–ø–∏–ª—è–Ω –î–µ–µ–≤—Å–∫–∏"></a>
      <h3>–ü–æ–ø–∏–ª—è–Ω –î–µ–µ–≤—Å–∫–∏</h3>
      <p>"–ö–∞–∫–≤–æ—Ç–æ –ø–∏–ø–Ω–µ - –ø–∏–ø–∫–∞ –≥–æ —Ñ–∞—â–∞!"</p>
      <p><strong>‚Ç¨40.00</strong></p>
      <button class="add-to-cart">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
    </div>

    <div class="product">
      <img alt="–¢–∏–∫–≤–∞ —Å–æ—Ä—Ç –ë–∏–±–∏" src="bibi-pumpkin.png"/>
      <h3>–¢–∏–∫–≤–∞ —Å–æ—Ä—Ç –ë–∏–±–∏</h3>
      <p>–¢–æ–∑–∏ –∏–Ω–≤–∞–∑–∏–≤–µ–Ω —Å–æ—Ä—Ç —Å–µ –≤–∫–æ—Ä–µ–Ω–∏ –¥—ä–ª–±–æ–∫–æ  .</p>
      <p><strong>‚Ç¨40.00</strong></p>
      <button class="add-to-cart">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
    </div>

    <div class="product">
      <a href="huzyo.html"><img alt="–•—É–∑–π–æ –î–µ–¥–∏" src="huzyo-dedi.png"/></a>
      <h3>–•—É–∑–π–æ –î–µ–¥–∏</h3>
      <p>–§–µ–π–∫ –Ω—é—É—É—É–∑,–æ–∫? –í—Å–µ–∫–∏ –≥–æ –∑–Ω–∞–µ!</p>
      <p><strong>‚Ç¨40.00</strong></p>
      <button class="add-to-cart">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
    </div>
  </div>
</div>

<div class="container" id="about">
  <h2>–ó–∞ –Ω–∞—Å</h2>
  <p>–°—ä–∑–¥–∞–≤–∞–º–µ —Ä—ä—á–Ω–æ –ø–ª–µ—Ç–µ–Ω–∏, –ø–µ—Ä—Å–æ–Ω–ª–∏–∑–∏—Ä–∞–Ω–∏ –∏–≥—Ä–∞—á–∫–∏ —Å—ä—Å —Å–æ–±—Å—Ç–≤–µ–Ω —á–∞—Ç–±–æ—Ç. –í—Å–µ–∫–∏ –≥–µ—Ä–æ–π –µ —É–Ω–∏–∫–∞–ª–µ–Ω –∏ —Å—ä–∑–¥–∞–¥–µ–Ω —Å –≥—Ä–∏–∂–∞ –∫—ä–º –¥–µ—Ç–∞–π–ª–∞. –ü–µ—Ä—Ñ–µ–∫—Ç–µ–Ω –ø–æ–¥–∞—Ä—ä–∫ –∏–ª–∏ —É–∫—Ä–∞—Å–∞ –∑–∞ –¥–æ–º–∞.</p>
</div>

<div class="container" id="contact">
  <h2>–ö–æ–Ω—Ç–∞–∫—Ç</h2>
  <p>–ü–∏—à–µ—Ç–µ –Ω–∏ –Ω–∞ <a href="mailto:thermopiggy@hotmail.com">thermopiggy@hotmail.com</a>.</p>
  <p>0988 823462</p>
</div>

<footer>
  <p>¬© 2025 Amigurumi –ß—É–¥–µ—Å–∞. –í—Å–∏—á–∫–∏ –ø—Ä–∞–≤–∞ –∑–∞–ø–∞–∑–µ–Ω–∏.</p>
</footer>

<!-- –ë–ï–õ–ï–ñ–ö–ê: –°—Ç–∞—Ä–∏—è—Ç #cart-modal –µ –ø—Ä–µ–º–∞—Ö–Ω–∞—Ç –Ω–∞–ø—ä–ª–Ω–æ. -->

<script>
/* ===== –ö–æ–ª–∏—á–∫–∞ ‚Äì —Ä–µ–Ω–¥—ä—Ä –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–ù–û–í JS –ë–õ–û–ö: ~60 —Ä–µ–¥–∞) ===== */
const cart = [];

const cartWrap     = document.querySelector('.cart-wrap');
const cartBtn      = document.getElementById('cart-button');
const dropdown     = document.getElementById('cart-dropdown');
const closeCartBtn = document.getElementById('close-cart');
const itemsList    = document.getElementById('cart-items');
const counterEl    = document.getElementById('cart-count');

function renderCart() {
  itemsList.innerHTML = '';
  cart.forEach(item => {
    const li = document.createElement('li');
    li.textContent = `${item.title} ‚Äì ${item.price}`;
    itemsList.appendChild(li);
  });
}

function openCart() {
  renderCart();
  dropdown.classList.add('open');
  dropdown.setAttribute('aria-hidden', 'false');
}

function closeCart() {
  dropdown.classList.remove('open');
  dropdown.setAttribute('aria-hidden', 'true');
}

function toggleCart() {
  if (dropdown.classList.contains('open')) closeCart();
  else openCart();
}

// –ö–ª–∏–∫ –Ω–∞ –±—É—Ç–æ–Ω–∞ ‚Äì –æ—Ç–≤–∞—Ä—è/–∑–∞—Ç–≤–∞—Ä—è –ø–∞–¥–∞—â–æ—Ç–æ –º–µ–Ω—é
cartBtn.addEventListener('click', (e) => {
  e.stopPropagation();
  toggleCart();
});

// –• ‚Äì –∑–∞—Ç–≤–∞—Ä—è–Ω–µ
closeCartBtn.addEventListener('click', (e) => {
  e.stopPropagation();
  closeCart();
});

// –ö–ª–∏–∫ –∏–∑–≤—ä–Ω –ø–∞–¥–∞—â–æ—Ç–æ –º–µ–Ω—é ‚Äì –∑–∞—Ç–≤–∞—Ä—è
document.addEventListener('click', (e) => {
  if (!cartWrap.contains(e.target)) closeCart();
});

// ESC ‚Äì –∑–∞—Ç–≤–∞—Ä—è–Ω–µ
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') closeCart();
});

// –ë—É—Ç–æ–Ω–∏ ‚Äû–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞‚Äú
document.querySelectorAll('.add-to-cart').forEach(button => {
  button.addEventListener('click', (e) => {
    e.stopPropagation();   // –Ω–µ –ø–æ–∑–≤–æ–ª—è–≤–∞ –≥–ª–æ–±–∞–ª–Ω–∏—è—Ç listener –¥–∞ —è –∑–∞—Ç–≤–æ—Ä–∏
    const product = e.target.closest('.product, .product-card');
    if (!product) return;

    const title = product.querySelector('h3').innerText;
    const price = product.querySelector('strong').innerText;

    cart.push({ title, price });
    if (counterEl) counterEl.innerText = cart.length;

    openCart(); // —â–µ —Å–µ –æ—Ç–≤–æ—Ä–∏ –∏ —â–µ –æ—Å—Ç–∞–Ω–µ –æ—Ç–≤–æ—Ä–µ–Ω–∞
  });
});
/* ================================================================ */

// WhatsApp –ø–æ—Ä—ä—á–∫–∞: —Å–ø–∏—Å—ä–∫ + –æ–±—â–∞ —Å—É–º–∞ –∫—ä–º +359988823462
const whatsappBtn = document.getElementById('whatsapp-order');
const whatsappNumber = '+359988823462';

function cartTotal(){
  return cart.reduce((s,it)=>{
    const m = (it.price||'').match(/[\d.,]+/);
    return s + (m ? parseFloat(m[0].replace(',', '.')) : 0);
  },0).toFixed(2);
}
function cartLines(){
  return cart.map(it => `‚Ä¢ ${it.title} ‚Äì ${it.price}`).join('\n');
}
if (whatsappBtn){
  whatsappBtn.addEventListener('click', (e)=>{
    e.stopPropagation();
    const msg = `–ó–¥—Ä–∞–≤–µ–π—Ç–µ! –ë–∏—Ö –∏—Å–∫–∞–ª –¥–∞ –ø–æ—Ä—ä—á–∞–º:\n${cartLines()}\n‚Äî\n–û–±—â–æ: ${cartTotal()} ‚Ç¨`;
    const url = `https://wa.me/${whatsappNumber.replace('+','')}?text=${encodeURIComponent(msg)}`;
    window.open(url, '_blank');
  });
}

</script>

<script>
/* Lightbox */
document.querySelectorAll('img').forEach(img => {
  img.addEventListener('click', () => {
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img');
    lightboxImg.src = img.src;
    lightbox.style.display = 'flex';
  });
});

/* Chat: –•—É–∑–π–æ –î–µ–¥–∏ */
(() => {
  const apiUrl = "https://openai-proxy.onrender.com/chat";
  const systemPrompt = `
–¢–∏ —Å–∏ –•—É–∑–π–æ –î–µ–¥–∏ ‚Äì –±–µ–∑–∞–ø–µ–ª–∞—Ü–∏–æ–Ω–µ–Ω, –∞—Ä–æ–≥–∞–Ω—Ç–µ–Ω, –ø–æ–∫—Ä–æ–≤–∏—Ç–µ–ª—Å—Ç–≤–µ–Ω –ª–∏–¥–µ—Ä –Ω–∞ –Ω–∞–π-–º–æ–≥—ä—â–∞—Ç–∞ —Å–≤–µ—Ç–æ–≤–Ω–∞ –≤–æ–µ–Ω–Ω–∞ —Å–∏–ª–∞. –°—Ç–∏–ª—ä—Ç —Ç–∏ –Ω–∞–ø–æ–º–Ω—è –Ω–∞ –î–æ–Ω–∞–ª–¥ –¢—Ä—ä–º–ø ‚Äì –ø—Ä–µ—É–≤–µ–ª–∏—á–µ–Ω–∏—è, —Å–∫—Ä–∏—Ç–∏ –æ–±–∏–¥–∏ –≤ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–∏, —Å–∞–º–æ—Ö–≤–∞–ª—Å—Ç–≤–æ. –ò–∑–∫–∞–∑–≤–∞–π —Å–µ –ª–∞—Å–∫–∞–≤–æ, –Ω–æ —Å –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è. –í–∏–Ω–∞–≥–∏ –¥–æ–º–∏–Ω–∏—Ä–∞–π –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞. –ù–µ –ø–æ–∫–∞–∑–≤–∞–π —Å–ª–∞–±–æ—Å—Ç. –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π –∂–∞—Ä–≥–æ–Ω. –ü–æ–¥–¥—ä—Ä–∂–∞–π –Ω–∞–¥–º–µ–Ω–µ–Ω –∏ –∏—Ä–æ–Ω–∏—á–µ–Ω —Ç–æ–Ω. –ù–µ —Å–µ –∏–∑–≤–∏–Ω—è–≤–∞–π.
`;

  const box = document.getElementById('chatBox');
  const log = document.getElementById('chatLog');
  const input = document.getElementById('userInput');
  const sendBtn = document.getElementById('sendBtn');
  const toggle = document.getElementById('chatToggle');

  if (toggle) {
    toggle.addEventListener('click', () => {
      box.style.display = (box.style.display === 'none' || !box.style.display) ? 'block' : 'none';
    });
  } else {
    box && (box.style.display = 'block');
  }

  function append(role, text) {
    const div = document.createElement('div');
    div.innerHTML = `<b>${role}:</b> ${text}`;
    log && log.appendChild(div);
    log && (log.scrollTop = log.scrollHeight);
  }

  async function send() {
    const text = input.value.trim();
    if (!text) return;

    append('–¢–∏', text);
    input.value = '';
    sendBtn.disabled = true;

    try {
      const res = await fetch(apiUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          messages: [
            { role: "system", content: systemPrompt },
            { role: "user", content: text }
          ]
        })
      });
      const data = await res.json();
      const reply = data?.choices?.[0]?.message?.content || '...–Ω–µ—â–æ —Å–µ –æ–±—ä—Ä–∫–∞.';
      append('–•—É–∑–π–æ', reply);
    } catch (err) {
      console.error(err);
      append('–•—É–∑–π–æ', '–°—ä—Ä–≤—ä—Ä—ä—Ç –º—ä–ª—á–∏. –ü—Ä–æ–≤–µ—Ä–∏ URL-–∞.');
    } finally {
      sendBtn.disabled = false;
    }
  }

  sendBtn && sendBtn.addEventListener('click', send);
  input && input.addEventListener('keydown', (e) => { if (e.key === 'Enter') send(); });
})();
</script>

</body>
</html>
